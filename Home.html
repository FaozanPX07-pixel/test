<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>===============</title>
    <link rel="stylesheet" href="./css/Stylist.css">
</head>

<body>
    <!-- HEADER -->
    <header class="sticky-header" id="header">
        <div class="header-content">
            <div class="header-left">
                <div class="menu-btn" onclick="toggleSidebar()" aria-label="Toggle menu" title="Toggle menu">‚ò∞</div>

                <!-- theme toggle -->
                <div id="theme-toggle" class="theme-toggle" aria-label="Toggle theme" title="Toggle theme">‚òæ</div>

            </div>

            <div class="header-center">
                <nav style="margin:auto;">
                    <ul class="ul-nav">
                        <li class="li-nav"><a href="Home.html">Home</a></li>
                        <li class="li-nav"><a href="Profile.html">Profile</a></li>
                        <li class="li-nav"><a href="Projects.html">Project</a></li>
                        <li class="li-nav"><a href="Media.html">Media</a></li>
                        <li class="li-nav"><a href="Contact.html">Contact</a></li>
                    </ul>
                </nav>
            </div>

            <div class="header-right" id="signin-area">
                <!-- AUTO GENERATED BY JS -->
            </div>
        </div>
    </header>

    <!-- SIDEBAR -->
    <div id="sidebar" class="sidebar" aria-hidden="true">
        <div class="sidebar-content">
            <div class="profile-container">
                <img src="./assets/img/PROFILE.jpg" alt="My Profile" />
            </div>
            <div class="info-media-wrapper">
                <div class="Konten-sidebar">
                    <h3>Informasi Tambahan</h3>
                    <ul>
                        <li>üìÖ Tanggal Update: <b>03 January 2026</b></li>
                        <li>üåê Status: <span id="login-status">Checking...</span></li>
                        <li>‚ö° Motto: "Kode adalah senjata, logika adalah tameng."</li>
                        <li>üí¨ Pesan Dari Admin: Jangan berhenti di error pertama.</li>
                    </ul>
                </div>
            </div>
        </div>

        <a href="Profile.html" class="bottom-link">About</a>
    </div>

    <main>
        <!-- TITLE WITH TYPEWRITER -->
        <div class="title">
            <div>
                <div id="title-text">WELCOME</div>
            </div>
        </div>

        <!-- TYPEWRITER AUTO SWITCHING SCRIPT -->
        <script>
            const titleEl = document.getElementById("title-text");
            const msg1 = "WELCOME";
            const msg2 = "WISHING YOU PEACE & MOONLIGHT";

            setTimeout(() => {
                titleEl.style.animation = "none";
                titleEl.offsetHeight;
                titleEl.textContent = msg2;
                titleEl.style.animation = "typing 6s steps(40) forwards, blink 10s infinite";
            }, 4000);
        </script>

        <!-- MAIN SCRIPTS -->
        <script>
            // ==========================================
            // LOGIN SYSTEM WITH SESSION & PERSISTENT STORAGE
            // ==========================================

            const AUTH_KEY = 'userAuth';
            const SESSION_KEY = 'sessionAuth';

            // Get login data from memory (from login page) or storage
            function getLoginData() {
                // Priority 1: Check if coming from login page (window.loginState)
                if (window.loginState) {
                    return window.loginState;
                }

                // Priority 2: Check sessionStorage (for session-only login)
                const sessionData = sessionStorage.getItem(SESSION_KEY);
                if (sessionData) {
                    try {
                        return JSON.parse(sessionData);
                    } catch (e) {
                        console.error('Error parsing session data:', e);
                    }
                }

                // Priority 3: Check localStorage (for persistent login with "Remember Me")
                const persistentData = localStorage.getItem(AUTH_KEY);
                if (persistentData) {
                    try {
                        return JSON.parse(persistentData);
                    } catch (e) {
                        console.error('Error parsing persistent data:', e);
                    }
                }

                return null;
            }

            // Save login data
            function saveLoginData(data, rememberMe = false) {
                // Always save to sessionStorage for current session
                sessionStorage.setItem(SESSION_KEY, JSON.stringify(data));

                // If "Remember Me" is checked, also save to localStorage
                if (rememberMe && data.isLoggedIn) {
                    localStorage.setItem(AUTH_KEY, JSON.stringify(data));
                } else {
                    // If not remembering, clear localStorage
                    localStorage.removeItem(AUTH_KEY);
                }
            }

            // Clear login data
            function clearLoginData() {
                sessionStorage.removeItem(SESSION_KEY);
                localStorage.removeItem(AUTH_KEY);
                window.loginState = null;
            }

            // Auto-logout when browser/tab closes (if not "Remember Me")
            window.addEventListener('beforeunload', function() {
                const loginData = getLoginData();

                // If there's no persistent data in localStorage, 
                // it means user didn't check "Remember Me"
                const hasPersistentLogin = localStorage.getItem(AUTH_KEY);

                if (!hasPersistentLogin && loginData && loginData.isLoggedIn) {
                    // Clear session data on close
                    sessionStorage.removeItem(SESSION_KEY);
                }
            });

            // ==========================================
            // LOGIN UI MANAGEMENT
            // ==========================================

            (function() {
                let loginData = getLoginData();
                let isLoggedIn = loginData ? loginData.isLoggedIn : false;
                let username = loginData ? loginData.username : "Guest";
                let avatarURL = loginData ? loginData.avatarURL : "profile.jpg";
                let rememberMe = loginData ? loginData.rememberMe : false;

                const signinArea = document.getElementById("signin-area");
                const loginStatus = document.getElementById("login-status");

                // Update sidebar status
                function updateLoginStatus() {
                    if (loginStatus) {
                        if (isLoggedIn) {
                            loginStatus.innerHTML = '<b style="color: #00ff00;">Online (Logged In)</b>';
                        } else {
                            loginStatus.innerHTML = '<b style="color: #ff9800;">Guest Mode</b>';
                        }
                    }
                }

                function renderSignInMenu() {
                    if (!isLoggedIn) {
                        // Show Sign In button for guests
                        signinArea.innerHTML = `
                            <div class="li-nav">
                                <a href="Index.html">üîê Sign In</a>
                            </div>
                        `;
                    } else {
                        // Show account box for logged-in users
                        signinArea.innerHTML = `
                            <div class="account-box" id="account-box">
                                <img src="./assets/img/PROFILE.jpg" alt="User Avatar" 
                                     onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27100%27 height=%27100%27%3E%3Crect fill=%27%233b82f6%27 width=%27100%27 height=%27100%27/%3E%3Ctext x=%2750%25%27 y=%2750%25%27 dominant-baseline=%27middle%27 text-anchor=%27middle%27 font-size=%2740%27 fill=%27white%27%3E${username.charAt(0)}%3C/text%3E%3C/svg%3E'">
                                <span>MASTER Z007</span>
                                <div class="dropdown-menu" id="dropdown-menu">
                                    <a href="Profile.html">üë§ My Profile</a>
                                    <a href="#" id="logout-btn">üö™ Logout</a>
                                </div>
                            </div>
                        `;

                        const accountBox = document.getElementById("account-box");

                        // Toggle dropdown
                        accountBox.addEventListener("click", function(e) {
                            e.stopPropagation();
                            accountBox.classList.toggle("dropdown-open");
                        });

                        // Close dropdown when clicking outside
                        document.addEventListener("click", function(e) {
                            if (!accountBox.contains(e.target)) {
                                accountBox.classList.remove("dropdown-open");
                            }
                        });

                        // Logout functionality
                        document.getElementById("logout-btn").addEventListener("click", function(e) {
                            e.preventDefault();

                            // Clear all login data
                            clearLoginData();

                            // Update UI state
                            isLoggedIn = false;
                            username = "Guest";

                            // Animate logout
                            accountBox.style.transform = 'scale(0.8)';
                            accountBox.style.opacity = '0';

                            setTimeout(() => {
                                renderSignInMenu();
                                updateLoginStatus();

                                // Show logout notification
                                showNotification('‚úÖ Logout berhasil! Anda sekarang dalam Guest Mode.');
                            }, 300);
                        });
                    }

                    updateLoginStatus();
                }

                // Notification function
                function showNotification(message) {
                    const notification = document.createElement('div');
                    notification.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: rgba(59, 130, 246, 0.95);
                        color: white;
                        padding: 15px 25px;
                        border-radius: 10px;
                        box-shadow: 0 5px 20px rgba(59, 130, 246, 0.5);
                        z-index: 10000;
                        animation: slideIn 0.3s ease;
                        font-weight: bold;
                    `;
                    notification.textContent = message;
                    document.body.appendChild(notification);

                    setTimeout(() => {
                        notification.style.animation = 'slideOut 0.3s ease';
                        setTimeout(() => notification.remove(), 300);
                    }, 3000);
                }

                // Save current state if coming from login page
                if (window.loginState) {
                    // Check if user wants to be remembered (you can add this to login page)
                    const rememberMe = window.loginState.rememberMe || false;
                    saveLoginData(window.loginState, rememberMe);
                }

                // Initial render
                renderSignInMenu();

                // Show welcome message for logged-in users
                if (isLoggedIn && window.loginState) {
                    setTimeout(() => {
                        showNotification(`üéâ Selamat datang, ${username}!`);
                    }, 500);
                }
            })();

            // ==========================================
            // SIDEBAR & THEME TOGGLE
            // ==========================================

            // Sidebar toggle
            const sidebar = document.getElementById("sidebar");
            const menuBtn = document.querySelector(".menu-btn");

            function toggleSidebar() {
                const isOpen = sidebar.classList.toggle("open");
                sidebar.setAttribute("aria-hidden", !isOpen);
            }

            document.addEventListener("click", (e) => {
                // if click outside sidebar and not on menu button, close sidebar
                if (!sidebar.contains(e.target) && !menuBtn.contains(e.target)) {
                    sidebar.classList.remove("open");
                    sidebar.setAttribute("aria-hidden", "true");
                }
            });

            // Theme toggle with animation and localStorage
            const themeBtn = document.getElementById("theme-toggle");
            const THEME_KEY = "theme"; // 'light' or 'dark'

            function applyTheme(mode) {
                if (mode === "light") {
                    document.body.classList.add("light-mode");
                    themeBtn.textContent = "‚òÄ";
                } else {
                    document.body.classList.remove("light-mode");
                    themeBtn.textContent = "‚òæ";
                }
            }

            // load saved theme (default: dark)
            const savedMode = localStorage.getItem(THEME_KEY);
            applyTheme(savedMode);

            // animated toggle handler
            themeBtn.addEventListener("click", () => {
                // visual click animation
                themeBtn.classList.add("active");
                setTimeout(() => themeBtn.classList.remove("active"), 420);

                const currentIsLight = document.body.classList.contains("light-mode");
                const newMode = currentIsLight ? "dark" : "light";
                localStorage.setItem(THEME_KEY, newMode);
                applyTheme(newMode);
            });

            // optional: close sidebar on Escape
            document.addEventListener("keydown", (e) => {
                if (e.key === "Escape") {
                    sidebar.classList.remove("open");
                    sidebar.setAttribute("aria-hidden", "true");
                }
            });

            // Add CSS for notification animations
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from {
                        transform: translateX(400px);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(0);
                        opacity: 1;
                    }
                }
                
                @keyframes slideOut {
                    from {
                        transform: translateX(0);
                        opacity: 1;
                    }
                    to {
                        transform: translateX(400px);
                        opacity: 0;
                    }
                }
            `;
            document.head.appendChild(style);
        </script>

        <!-- CONTENT SECTION -->
        <div class="scene">
            <div class="content">
                <p style="color: #3b82f6;">
                    <br>
                    <br> / \&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/ \
                    <br> /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\_______/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\
                    <br> |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
                    <br> |&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;----&nbsp;&nbsp;&nbsp;|
                    <br> [&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]
                    <br> |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;¬ª&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
                    <br> |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_____&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
                    <br> |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|
                    <br> \_______________/ <br><br> DON'T CRY <br><br>
                </p>
                <h2>NEVER GIVE UP ANYTHING HAPPENS</h2>
                <br>
                <br>
            </div>
        </div>

    </main>

    <!-- FOOTER -->
    <footer style="text-align:center; padding:15px; color: #3b82f6; border-top:2px solid #3b82f6; background:rgba(0,0,0,0.7);">
        <p>&copy; 2007 MASTER Z007</p>
    </footer>

</body>

</html>