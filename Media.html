<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>===============</title>
    <link rel="stylesheet" href="./css/Stylist.css">
</head>

<body>
    <!-- STICKY HEADER -->
    <header class="sticky-header" id="header">
        <div class="header-content">
            <div class="header-left">
                <div class="menu-btn" onclick="toggleSidebar()" aria-label="Toggle menu" title="Toggle menu">‚ò∞</div>
                <div id="theme-toggle" class="theme-toggle" aria-label="Toggle theme" title="Toggle theme">‚òæ</div>
            </div>

            <div class="header-center">
                <nav style="margin:auto;">
                    <ul class="ul-nav">
                        <li class="li-nav"><a href="Home.html">Home</a></li>
                        <li class="li-nav"><a href="Profile.html">Profile</a></li>
                        <li class="li-nav"><a href="Projects.html">Project</a></li>
                        <li class="li-nav"><a href="Media.html">Media</a></li>
                        <li class="li-nav"><a href="Contact.html">Contact</a></li>
                    </ul>
                </nav>
            </div>

            <div class="header-right" id="signin-area"></div>
        </div>
    </header>

    <!-- SIDEBAR -->
    <div id="sidebar" class="sidebar" aria-hidden="true">
        <div class="sidebar-content">
            <div class="profile-container">
                <img src="./assets/img/PROFILE.jpg" alt="My Profile" />
            </div>
            <div class="info-media-wrapper">
                <div class="Konten-sidebar">
                    <h3>Informasi Tambahan</h3>
                    <ul>
                        <li>üìÖ Tanggal Update: <b>03 January 2026</b></li>
                        <li>üåê Status: <span id="login-status">Checking...</span></li>
                        <li>‚ö° Motto: "Kode adalah senjata, logika adalah tameng."</li>
                        <li>üí¨ Pesan Dari Admin: Jangan berhenti di error pertama.</li>
                    </ul>
                </div>
            </div>
        </div>

        <a href="Profile.html" class="bottom-link">About</a>
    </div>

    <!-- MAIN CONTENT -->
    <div class="media container">
        <div class="media-header">
            <h2 class="media-title">Media Kreasi</h2>
            <p class="media-subtitle">Jelajahi berbagai jenis konten media berupa video, audio, gambar, dan dokumen.</p>
        </div>

        <!-- FILTER BUTTONS -->
        <div class="filter-buttons" role="tablist" aria-label="Filter media">
            <button class="filter-btn active" data-filter="all">Semua</button>
            <button class="filter-btn" data-filter="Video">Video</button>
            <button class="filter-btn" data-filter="Audio">Audio</button>
            <button class="filter-btn" data-filter="Image">Image</button>
            <button class="filter-btn" data-filter="Dokument">Dokument</button>
        </div>

        <!-- Video Tab -->
        <div class="media-item" data-category="Video" tabindex="0">
            <h3 class="section-title">Video Tutorial & Presentasi</h3>
            <div class="video-grid">
                <div class="video-card">
                    <div class="video-thumbnail" data-src="./assets/videos/3 menit Hentikan malas.mp4" style="background-image: url('./assets/img/malas.jpg'); background-size: cover; background-position: center;">‚ñ∂</div>
                    <div class="video-info">
                        <h4 class="video-title">3 Menit Hentikan Malas</h4>
                        <p class="video-desc">Trik Jitu untuk Menghilangkan Malas dan Menjadi Produktif</p>
                        <div class="video-meta"><span>Durasi: 03:57</span></div>
                    </div>
                </div>

                <div class="video-card">
                    <div class="video-thumbnail" data-src="./assets/videos/4 Menit Buat Kamu Berfikir Cerdas Menjadi Cerdas.mp4" style="background-image: url('./assets/img/CaraBelajar.jpg'); background-size: cover; background-position: center;">‚ñ∂</div>
                    <div class="video-info">
                        <h4 class="video-title">4 Menit Buat Kamu Berfikir Cerdas</h4>
                        <p class="video-desc">Sering Lupa Pelajaran?? Bisa Jadi Kamu Melakukan Kesalahan yang Sama!</p>
                        <div class="video-meta"><span>Durasi: 04:02</span></div>
                    </div>
                </div>

                <div class="video-card">
                    <div class="video-thumbnail" data-src="./assets/videos/Kenapa Kita Gugup Kalau Ngomong di Depan Umum.mp4" style="background-image: url('./assets/img/glossophobia.jpg'); background-size: cover; background-position: center;">‚ñ∂</div>
                    <div class="video-info">
                        <h4 class="video-title">Glossophobia</h4>
                        <p class="video-desc">Kenapa Ngomong di Depan Umum Itu Begitu Menakutkan??</p>
                        <div class="video-meta"><span>Durasi: 03:41</span></div>
                    </div>
                </div>

                <div class="video-card">
                    <div class="video-thumbnail" data-src="./assets/videos/Gimana Cara Hacker Ngebajak Komputer.mp4" style="background-image: url('./assets/img/hacking.jpg'); background-size: cover; background-position: center;">‚ñ∂</div>
                    <div class="video-info">
                        <h4 class="video-title">(-_-)</h4>
                        <p class="video-desc">Gimana Sebenarnya Cara Hacker Ngebajak Komputer??</p>
                        <div class="video-meta"><span>Durasi: 04:03</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- AUDIO SECTION -->
        <div class="media-item" data-category="Audio">
            <h3 class="section-title">Music Favorite</h3>
            <div class="audio-grid">
                <div class="audio-card">
                    <div class="audio-header">
                        <div class="audio-icon">üéµ</div>
                        <h4 class="audio-title">Hello Worker</h4>
                    </div>
                    <audio class="audio-file">
                        <source src="./assets/musics/Hello Worker (English Cover)„ÄêJubyPhonic„Äë.mp3" type="audio/mp3">
                    </audio>
                    <input type="range" class="audio-progress" value="0" max="100">
                    <button class="play-btn">‚ñ∂</button>
                </div>

                <div class="audio-card">
                    <div class="audio-header">
                        <div class="audio-icon">üéµ</div>
                        <h4 class="audio-title">Where We Belong</h4>
                    </div>
                    <audio class="audio-file">
                        <source src="./assets/musics/Elian Skye - Where We Belong.mp3" type="audio/mp3">
                    </audio>
                    <input type="range" class="audio-progress" value="0" max="100">
                    <button class="play-btn">‚ñ∂</button>
                </div>

                <div class="audio-card">
                    <div class="audio-header">
                        <div class="audio-icon">üéµ</div>
                        <h4 class="audio-title">IF (Japanese song)</h4>
                    </div>
                    <audio class="audio-file">
                        <source src="./assets/musics/Ë•øÈáé„Ç´„Éä„Äé if „ÄèMV Full.mp3" type="audio/mp3">
                    </audio>
                    <input type="range" class="audio-progress" value="0" max="100">
                    <button class="play-btn">‚ñ∂</button>
                </div>

                <div class="audio-card">
                    <div class="audio-header">
                        <div class="audio-icon">üéµ</div>
                        <h4 class="audio-title">Sad Sometimes</h4>
                    </div>
                    <audio class="audio-file">
                        <source src="./assets/musics/Alan Walker CORSAK & Huang Xiaoyun - Sad Sometimes (Lyrics).mp3" type="audio/mp3">
                    </audio>
                    <input type="range" class="audio-progress" value="0" max="100">
                    <button class="play-btn">‚ñ∂</button>
                </div>

                <div class="audio-card">
                    <div class="audio-header">
                        <div class="audio-icon">üéµ</div>
                        <h4 class="audio-title">Clarity</h4>
                    </div>
                    <audio class="audio-file">
                        <source src="./assets/musics/Clarity by Zedd ft. Foxes Kyokoro Cover.mp3" type="audio/mp3">
                    </audio>
                    <input type="range" class="audio-progress" value="0" max="100">
                    <button class="play-btn">‚ñ∂</button>
                </div>

                <div class="audio-card">
                    <div class="audio-header">
                        <div class="audio-icon">üéµ</div>
                        <h4 class="audio-title">Be Alright</h4>
                    </div>
                    <audio class="audio-file">
                        <source src="./assets/musics/Nightcore - Be Alright.mp3" type="audio/mp3">
                    </audio>
                    <input type="range" class="audio-progress" value="0" max="100">
                    <button class="play-btn">‚ñ∂</button>
                </div>
            </div>
        </div>

        <!-- IMAGE CAROUSEL SECTION -->
        <div class="media-item" data-category="Image">
            <h3 class="section-title">Galeri Gambar & Desain</h3>
            <div class="carousel-container">
                <button class="arrow-btn prev" onclick="moveSlide(-1)">‚Äπ</button>
                <button class="arrow-btn next" onclick="moveSlide(1)">‚Ä∫</button>
                <div class="carousel-slider">
                    <div class="slider-item">
                        <img src="./assets/img/Contoh-desain-website-company-profile-www.dasmovers.com_.jpg" alt="Web Design">
                        <div class="image-overlay">
                            <div class="image-title">Web Design</div>
                            <div class="image-desc">Design web modern dan responsif</div>
                        </div>
                    </div>

                    <div class="slider-item active">
                        <img src="./assets/img/Arduino-UNO-Parts-Marking.jpg" alt="Arduino Uno">
                        <div class="image-overlay">
                            <div class="image-title">Arduino Uno</div>
                            <div class="image-desc">Arduino Uno Board</div>
                        </div>
                    </div>

                    <div class="slider-item">
                        <img src="./assets/img/esp32-pinout.jpg" alt="ESP32">
                        <div class="image-overlay">
                            <div class="image-title">ESP32</div>
                            <div class="image-desc">ESP32 Board</div>
                        </div>
                    </div>

                    <div class="slider-item">
                        <img src="./assets/img/ESP8266-Pinout-Datasheet-Features-Applications.png.webp" alt="ESP8266">
                        <div class="image-overlay">
                            <div class="image-title">ESP8266</div>
                            <div class="image-desc">ESP8266 Board</div>
                        </div>
                    </div>

                    <div class="slider-item">
                        <img src="./assets/img/robomind25Screenshot.jpg" alt="RoboMind">
                        <div class="image-overlay">
                            <div class="image-title">RoboMind</div>
                            <div class="image-desc">Mini Game Robotics</div>
                        </div>
                    </div>


                    <div class="slider-item">
                        <img src="./assets/img/soccer_robo.jpeg" alt="Soccer Robo">
                        <div class="image-overlay">
                            <div class="image-title">Robotics Project</div>
                            <div class="image-desc">Soccer Robo</div>
                        </div>
                    </div>
                </div>

                <div class="navigation">
                    <button class="nav-dot active" onclick="goToSlide(0)"></button>
                    <button class="nav-dot" onclick="goToSlide(1)"></button>
                    <button class="nav-dot" onclick="goToSlide(2)"></button>
                    <button class="nav-dot" onclick="goToSlide(3)"></button>
                    <button class="nav-dot" onclick="goToSlide(4)"></button>
                    <button class="nav-dot" onclick="goToSlide(5)"></button>
                </div>
            </div>
        </div>

        <!-- DOCUMENT SECTION -->
        <div class="media-item" data-category="Dokument">
            <h3 class="section-title">Dokumen & Materi Pembelajaran</h3>
            <div class="doc-grid">
                <div class="doc-card">
                    <div class="doc-icon">üìÑ</div>
                    <div class="doc-info">
                        <h4 class="doc-title">Arduino Projects</h4>
                        <div class="doc-meta"><span>PDF</span><span>8.2 MB</span></div>
                        <a href="./assets/dokument/PDF/Arduino Projects.pdf" class="doc-download" rel="noopener">Download</a>
                    </div>
                </div>

                <div class="doc-card">
                    <div class="doc-icon">üìÑ</div>
                    <div class="doc-info">
                        <h4 class="doc-title">ESP8266 Web Server</h4>
                        <div class="doc-meta"><span>PDF</span><span>1.7 MB</span></div>
                        <a href="./assets/dokument/PDF/ESP8266_Web_Server_with_Arduino_IDE.pdf" class="doc-download" rel="noopener">Download</a>
                    </div>
                </div>

                <div class="doc-card">
                    <div class="doc-icon">üìÑ</div>
                    <div class="doc-info">
                        <h4 class="doc-title">ESP32 Web Server</h4>
                        <div class="doc-meta"><span>PDF</span><span>2.7 MB</span></div>
                        <a href="./assets/dokument/PDF/ESP32_Web_Server_with_Arduino_IDE.pdf" class="doc-download" rel="noopener">Download</a>
                    </div>
                </div>

                <div class="doc-card">
                    <div class="doc-icon">üìÑ</div>
                    <div class="doc-info">
                        <h4 class="doc-title">NodeMCU ESP32</h4>
                        <div class="doc-meta"><span>PDF</span><span>0.7 MB</span></div>
                        <a href="./assets/dokument/PDF/NodeMCU ESP32.pdf" class="doc-download" rel="noopener">Download</a>
                    </div>
                </div>

                <div class="doc-card">
                    <div class="doc-icon">üìÑ</div>
                    <div class="doc-info">
                        <h4 class="doc-title">Panduan Soccer Robo</h4>
                        <div class="doc-meta"><span>PDF</span><span>1 MB</span></div>
                        <a href="./assets/dokument/PDF/SOCCER ROBOT MANUAL BOOK.pdf" class="doc-download" rel="noopener">Download</a>
                    </div>
                </div>

                <div class="doc-card">
                    <div class="doc-icon">üìÑ</div>
                    <div class="doc-info">
                        <h4 class="doc-title">USB DRIVER CH34x</h4>
                        <div class="doc-meta"><span>ZIP</span><span>0.2 MB</span></div>
                        <a href="./assets/dokument/ZIP/CH34x Driver.zip" class="doc-download" rel="noopener">Download</a>
                    </div>
                </div>

                <div class="doc-card">
                    <div class="doc-icon">üìÑ</div>
                    <div class="doc-info">
                        <h4 class="doc-title">USB DRIVER CP210x</h4>
                        <div class="doc-meta"><span>ZIP</span><span>3.4 MB</span></div>
                        <a href="./assets/dokument/ZIP/CP210x Drivers.zip" class="doc-download" rel="noopener">Download</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- VIDEO MODAL -->
    <div class="lightbox" id="video-modal">
        <button class="lightbox-close" id="video-close">&times;</button>
        <div id="video-frame-container" style="width:100%;height:100%;background:#000;display:flex;align-items:center;justify-content:center;"></div>
        <div class="lightbox-caption" id="video-caption">Video Tutorial</div>
    </div>

    <!-- IMAGE LIGHTBOX -->
    <div class="lightbox" id="image-lightbox">
        <button class="lightbox-close" id="image-close">&times;</button>
        <img src="" alt="" class="lightbox-content" id="lightbox-img">
        <div class="lightbox-caption" id="lightbox-caption"></div>
    </div>

    <!-- FOOTER -->
    <footer>
        <p>&copy; 2007 MASTER Z007</p>
    </footer>

    <!-- JAVASCRIPT -->
    <script>
        // ===== SIDEBAR TOGGLE =====
        const sidebar = document.getElementById("sidebar");
        const menuBtn = document.querySelector(".menu-btn");

        function toggleSidebar() {
            const isOpen = sidebar.classList.toggle("open");
            sidebar.setAttribute("aria-hidden", !isOpen);
        }

        document.addEventListener("click", (e) => {
            if (!sidebar.contains(e.target) && !menuBtn.contains(e.target)) {
                sidebar.classList.remove("open");
                sidebar.setAttribute("aria-hidden", "true");
            }
        });

        document.addEventListener("keydown", (e) => {
            if (e.key === "Escape") {
                sidebar.classList.remove("open");
                sidebar.setAttribute("aria-hidden", "true");
            }
        });

        // ===== THEME TOGGLE =====
        const themeBtn = document.getElementById("theme-toggle");
        const THEME_KEY = "theme";

        function applyTheme(mode) {
            if (mode === "light") {
                document.body.classList.add("light-mode");
                themeBtn.textContent = "‚òÄ";
            } else {
                document.body.classList.remove("light-mode");
                themeBtn.textContent = "‚òæ";
            }
        }

        const savedMode = localStorage.getItem(THEME_KEY);
        applyTheme(savedMode);

        themeBtn.addEventListener("click", () => {
            themeBtn.classList.add("active");
            setTimeout(() => themeBtn.classList.remove("active"), 420);

            const currentIsLight = document.body.classList.contains("light-mode");
            const newMode = currentIsLight ? "dark" : "light";
            localStorage.setItem(THEME_KEY, newMode);
            applyTheme(newMode);
        });

        // ===== LOGIN SYSTEM =====
        const AUTH_KEY = 'userAuth';
        const SESSION_KEY = 'sessionAuth';

        // Get login data from memory (from login page) or storage
        function getLoginData() {
            // Priority 1: Check if coming from login page (window.loginState)
            if (window.loginState) {
                return window.loginState;
            }

            // Priority 2: Check sessionStorage (for session-only login)
            const sessionData = sessionStorage.getItem(SESSION_KEY);
            if (sessionData) {
                try {
                    return JSON.parse(sessionData);
                } catch (e) {
                    console.error('Error parsing session data:', e);
                }
            }

            // Priority 3: Check localStorage (for persistent login with "Remember Me")
            const persistentData = localStorage.getItem(AUTH_KEY);
            if (persistentData) {
                try {
                    return JSON.parse(persistentData);
                } catch (e) {
                    console.error('Error parsing persistent data:', e);
                }
            }

            return null;
        }

        // Save login data
        function saveLoginData(data, rememberMe = false) {
            // Always save to sessionStorage for current session
            sessionStorage.setItem(SESSION_KEY, JSON.stringify(data));

            // If "Remember Me" is checked, also save to localStorage
            if (rememberMe && data.isLoggedIn) {
                localStorage.setItem(AUTH_KEY, JSON.stringify(data));
            } else {
                // If not remembering, clear localStorage
                localStorage.removeItem(AUTH_KEY);
            }
        }

        // Clear login data
        function clearLoginData() {
            sessionStorage.removeItem(SESSION_KEY);
            localStorage.removeItem(AUTH_KEY);
            window.loginState = null;
        }

        // Auto-logout when browser/tab closes (if not "Remember Me")
        window.addEventListener('beforeunload', function() {
            const loginData = getLoginData();

            // If there's no persistent data in localStorage, 
            // it means user didn't check "Remember Me"
            const hasPersistentLogin = localStorage.getItem(AUTH_KEY);

            if (!hasPersistentLogin && loginData && loginData.isLoggedIn) {
                // Clear session data on close
                sessionStorage.removeItem(SESSION_KEY);
            }
        });

        (function() {
            let loginData = getLoginData();
            let isLoggedIn = loginData ? loginData.isLoggedIn : false;
            let username = loginData ? loginData.username : "Guest";
            let avatarURL = loginData ? loginData.avatarURL : "profile.jpg";
            let rememberMe = loginData ? loginData.rememberMe : false;

            const signinArea = document.getElementById("signin-area");
            const loginStatus = document.getElementById("login-status");

            // Update sidebar status
            function updateLoginStatus() {
                if (loginStatus) {
                    if (isLoggedIn) {
                        loginStatus.innerHTML = '<b style="color: #00ff00;">Online (Logged In)</b>';
                    } else {
                        loginStatus.innerHTML = '<b style="color: #ff9800;">Guest Mode</b>';
                    }
                }
            }

            function renderSignInMenu() {
                if (!isLoggedIn) {
                    // Show Sign In button for guests
                    signinArea.innerHTML = `
                            <div class="li-nav">
                                <a href="Index.html">üîê Sign In</a>
                            </div>
                        `;
                } else {
                    // Show account box for logged-in users
                    signinArea.innerHTML = `
                            <div class="account-box" id="account-box">
                                <img src="./assets/img/PROFILE.jpg" alt="User Avatar" 
                                     onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%27http://www.w3.org/2000/svg%27 width=%27100%27 height=%27100%27%3E%3Crect fill=%27%233b82f6%27 width=%27100%27 height=%27100%27/%3E%3Ctext x=%2750%25%27 y=%2750%25%27 dominant-baseline=%27middle%27 text-anchor=%27middle%27 font-size=%2740%27 fill=%27white%27%3E${username.charAt(0)}%3C/text%3E%3C/svg%3E'">
                                <span>MASTER Z007</span>
                                <div class="dropdown-menu" id="dropdown-menu">
                                    <a href="Profile.html">üë§ My Profile</a>
                                    <a href="#" id="logout-btn">üö™ Logout</a>
                                </div>
                            </div>
                        `;

                    const accountBox = document.getElementById("account-box");

                    // Toggle dropdown
                    accountBox.addEventListener("click", function(e) {
                        e.stopPropagation();
                        accountBox.classList.toggle("dropdown-open");
                    });

                    // Close dropdown when clicking outside
                    document.addEventListener("click", function(e) {
                        if (!accountBox.contains(e.target)) {
                            accountBox.classList.remove("dropdown-open");
                        }
                    });

                    // Logout functionality
                    document.getElementById("logout-btn").addEventListener("click", function(e) {
                        e.preventDefault();

                        // Clear all login data
                        clearLoginData();

                        // Update UI state
                        isLoggedIn = false;
                        username = "Guest";

                        // Animate logout
                        accountBox.style.transform = 'scale(0.8)';
                        accountBox.style.opacity = '0';

                        setTimeout(() => {
                            renderSignInMenu();
                            updateLoginStatus();

                            // Show logout notification
                            showNotification('‚úÖ Logout berhasil! Anda sekarang dalam Guest Mode.');
                        }, 300);
                    });
                }

                updateLoginStatus();
            }

            // Notification function
            function showNotification(message) {
                const notification = document.createElement('div');
                notification.style.cssText = `
                        position: fixed;
                        top: 20px;
                        right: 20px;
                        background: rgba(59, 130, 246, 0.95);
                        color: white;
                        padding: 15px 25px;
                        border-radius: 10px;
                        box-shadow: 0 5px 20px rgba(59, 130, 246, 0.5);
                        z-index: 10000;
                        animation: slideIn 0.3s ease;
                        font-weight: bold;
                    `;
                notification.textContent = message;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            }

            // Save current state if coming from login page
            if (window.loginState) {
                // Check if user wants to be remembered (you can add this to login page)
                const rememberMe = window.loginState.rememberMe || false;
                saveLoginData(window.loginState, rememberMe);
            }

            // Initial render
            renderSignInMenu();

            // Show welcome message for logged-in users
            if (isLoggedIn && window.loginState) {
                setTimeout(() => {
                    showNotification(`üéâ Selamat datang, ${username}!`);
                }, 500);
            }
        })();

        // ===== FILTER BUTTONS =====
        const filterButtons = document.querySelectorAll('.filter-btn');
        const mediaItems = document.querySelectorAll('.media-item');

        filterButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                filterButtons.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                const filter = btn.getAttribute('data-filter');

                mediaItems.forEach(item => {
                    if (filter === 'all' || item.getAttribute('data-category') === filter) {
                        item.style.display = 'block';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        });

        // ===== CAROUSEL SLIDER WITH INFINITE LOOP =====
        let currentIndex = 0;
        const slider = document.querySelector('.carousel-slider');
        const originalSlides = document.querySelectorAll('.slider-item');
        const dots = document.querySelectorAll('.nav-dot');

        // Clone slides untuk infinite loop
        const cloneCount = 3; // Jumlah slide yang di-clone di setiap sisi

        // Clone slides di awal
        for (let i = originalSlides.length - 1; i >= originalSlides.length - cloneCount; i--) {
            const clone = originalSlides[i].cloneNode(true);
            clone.classList.add('clone');
            slider.insertBefore(clone, slider.firstChild);
        }

        // Clone slides di akhir
        for (let i = 0; i < cloneCount; i++) {
            const clone = originalSlides[i].cloneNode(true);
            clone.classList.add('clone');
            slider.appendChild(clone);
        }

        const allSlides = document.querySelectorAll('.slider-item');
        const totalSlides = originalSlides.length;
        currentIndex = cloneCount; // Mulai dari slide asli pertama

        let isTransitioning = false;

        function updateSlider(smooth = true) {
            if (!allSlides[0]) return;

            const itemWidth = allSlides[0].offsetWidth + 20;

            if (smooth) {
                slider.classList.remove('no-transition');
            } else {
                slider.classList.add('no-transition');
            }

            slider.style.transform = `translateX(-${currentIndex * itemWidth}px)`;

            // Update active state
            allSlides.forEach((slide, index) => {
                slide.classList.remove('active');
                // Set middle item as active (index 1 dari visible slides)
                if (index === currentIndex + 1) {
                    slide.classList.add('active');
                }
            });

            // Update dots berdasarkan slide asli
            const actualIndex = ((currentIndex - cloneCount) % totalSlides + totalSlides) % totalSlides;
            const dotIndex = Math.min(actualIndex, dots.length - 1);
            dots.forEach((dot, index) => {
                dot.classList.remove('active');
                if (index === dotIndex) {
                    dot.classList.add('active');
                }
            });
        }

        function moveSlide(direction) {
            if (isTransitioning) return;

            isTransitioning = true;
            currentIndex += direction;
            updateSlider(true);

            setTimeout(() => {
                // Check infinite loop boundaries
                if (currentIndex <= cloneCount - 1) {
                    // Jump to end
                    currentIndex = totalSlides + cloneCount - 1;
                    updateSlider(false);
                } else if (currentIndex >= totalSlides + cloneCount) {
                    // Jump to start
                    currentIndex = cloneCount;
                    updateSlider(false);
                }
                isTransitioning = false;
            }, 800); // Match dengan duration transition
        }

        function goToSlide(index) {
            if (isTransitioning) return;

            isTransitioning = true;
            currentIndex = index + cloneCount;
            updateSlider(true);

            setTimeout(() => {
                isTransitioning = false;
            }, 800);

            resetAutoPlay();
        }

        let autoPlayInterval;

        function startAutoPlay() {
            autoPlayInterval = setInterval(() => {
                moveSlide(1);
            }, 4000); // Auto slide setiap 4 detik
        }

        function resetAutoPlay() {
            clearInterval(autoPlayInterval);
            startAutoPlay();
        }

        const carouselContainer = document.querySelector('.carousel-container');
        if (carouselContainer) {
            carouselContainer.addEventListener('mouseenter', () => {
                clearInterval(autoPlayInterval);
            });

            carouselContainer.addEventListener('mouseleave', () => {
                startAutoPlay();
            });
        }

        // Touch/Swipe support
        let touchStartX = 0;
        let touchEndX = 0;
        let isDragging = false;

        if (slider) {
            slider.addEventListener('touchstart', (e) => {
                touchStartX = e.changedTouches[0].screenX;
                isDragging = true;
            });

            slider.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                touchEndX = e.changedTouches[0].screenX;
            });

            slider.addEventListener('touchend', (e) => {
                if (!isDragging) return;
                isDragging = false;
                handleSwipe();
            });

            // Mouse drag support
            let mouseStartX = 0;
            let isMouseDown = false;

            slider.addEventListener('mousedown', (e) => {
                mouseStartX = e.clientX;
                isMouseDown = true;
                slider.style.cursor = 'grabbing';
            });

            slider.addEventListener('mousemove', (e) => {
                if (!isMouseDown) return;
                e.preventDefault();
            });

            slider.addEventListener('mouseup', (e) => {
                if (!isMouseDown) return;
                isMouseDown = false;
                slider.style.cursor = 'grab';

                const mouseEndX = e.clientX;
                const diff = mouseStartX - mouseEndX;

                if (Math.abs(diff) > 50) {
                    if (diff > 0) {
                        moveSlide(1);
                    } else {
                        moveSlide(-1);
                    }
                    resetAutoPlay();
                }
            });

            slider.addEventListener('mouseleave', () => {
                isMouseDown = false;
                slider.style.cursor = 'grab';
            });
        }

        function handleSwipe() {
            const diff = touchStartX - touchEndX;
            if (Math.abs(diff) > 50) {
                if (diff > 0) {
                    moveSlide(1);
                } else {
                    moveSlide(-1);
                }
                resetAutoPlay();
            }
        }

        // Initialize carousel
        if (slider && allSlides.length > 0) {
            slider.style.cursor = 'grab';
            updateSlider(false);
            startAutoPlay();

            // Update on window resize
            let resizeTimer;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(() => {
                    updateSlider(false);
                }, 250);
            });
        }

        // ===== VIDEO MODAL =====
        const videoThumbnails = document.querySelectorAll('.video-thumbnail');
        const videoModal = document.getElementById('video-modal');
        const videoClose = document.getElementById('video-close');
        const videoContainer = document.getElementById('video-frame-container');

        videoThumbnails.forEach(th => th.addEventListener('click', () => {
            const src = th.dataset.src;
            const title = th.closest('.video-card').querySelector('.video-title').textContent;
            videoContainer.innerHTML = `<video width="100%" height="100%" controls autoplay><source src="${src}" type="video/mp4">Browser Anda tidak mendukung video.</video>`;
            document.getElementById('video-caption').textContent = title;
            videoModal.classList.add('active');
        }));

        const closeVideoModal = () => {
            videoModal.classList.remove('active');
            videoContainer.innerHTML = '';
        };

        videoClose.addEventListener('click', closeVideoModal);
        videoModal.addEventListener('click', e => {
            if (e.target === videoModal) closeVideoModal();
        });

        // ===== AUDIO PLAYER =====
        const audioCards = document.querySelectorAll('.audio-card');
        audioCards.forEach(card => {
            const audio = card.querySelector('.audio-file');
            const playBtn = card.querySelector('.play-btn');
            const progress = card.querySelector('.audio-progress');

            playBtn.addEventListener('click', () => {
                if (audio.paused) {
                    document.querySelectorAll('.audio-file').forEach(a => a.pause());
                    document.querySelectorAll('.play-btn').forEach(b => b.textContent = '‚ñ∂');
                    audio.play();
                    playBtn.textContent = '‚ùö‚ùö';
                } else {
                    audio.pause();
                    playBtn.textContent = '‚ñ∂';
                }
            });

            audio.addEventListener('timeupdate', () => {
                if (audio.duration) progress.value = (audio.currentTime / audio.duration) * 100;
            });

            progress.addEventListener('input', () => {
                audio.currentTime = (progress.value / 100) * audio.duration;
            });
        });

        // ===== IMAGE LIGHTBOX =====
        const sliderItems = document.querySelectorAll('.slider-item');
        const imageLightbox = document.getElementById('image-lightbox');
        const lightboxImg = document.getElementById('lightbox-img');
        const lightboxCaption = document.getElementById('lightbox-caption');
        const imageClose = document.getElementById('image-close');

        sliderItems.forEach(item => {
            item.addEventListener('click', () => {
                const img = item.querySelector('img');
                const overlay = item.querySelector('.image-overlay');
                const title = overlay ? overlay.querySelector('.image-title').textContent : '';
                const desc = overlay ? overlay.querySelector('.image-desc').textContent : '';

                lightboxImg.src = img.src;
                lightboxImg.alt = title;
                lightboxCaption.textContent = title ? `${title} - ${desc}` : desc;
                imageLightbox.classList.add('active');
            });
        });

        imageClose.addEventListener('click', () => imageLightbox.classList.remove('active'));
        imageLightbox.addEventListener('click', (e) => {
            if (e.target === imageLightbox) imageLightbox.classList.remove('active');
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeVideoModal();
                imageLightbox.classList.remove('active');
            }
        });
    </script>
</body>

</html>